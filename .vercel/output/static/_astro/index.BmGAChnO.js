import{r as a}from"./index.TcFrwHGi.js";let i=[],f=0;const c=4,p=n=>{let r=[],e={get(){return e.lc||e.listen(()=>{})(),e.value},lc:0,listen(t){return e.lc=r.push(t),()=>{for(let u=f+c;u<i.length;)i[u]===t?i.splice(u,c):u+=c;let l=r.indexOf(t);~l&&(r.splice(l,1),--e.lc||e.off())}},notify(t,l){let u=!i.length;for(let s of r)i.push(s,e.value,t,l);if(u){for(f=0;f<i.length;f+=c)i[f](i[f+1],i[f+2],i[f+3]);i.length=0}},off(){},set(t){let l=e.value;l!==t&&(e.value=t,e.notify(l))},subscribe(t){let l=e.listen(t);return t(e.value),l},value:n};return e};function d(n,r,e){let t=new Set(r).add(void 0);return n.listen((l,u,s)=>{t.has(s)&&e(l,u,s)})}let o=(n,r)=>e=>{n.current!==e&&(n.current=e,r())};function S(n,{keys:r,deps:e=[n,r]}={}){let t=a.useRef();t.current=n.get();let l=a.useCallback(s=>(o(t,s)(n.value),r?.length>0?d(n,r,o(t,s)):n.listen(o(t,s))),e),u=()=>t.current;return a.useSyncExternalStore(l,u,u)}export{p as a,S as u};
